<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>License Verification</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 700px;
      margin: 40px auto;
      padding: 20px;
      line-height: 1.6;
      color: #222;
    }
    .status {
      padding: 12px 16px;
      border-radius: 6px;
      font-weight: bold;
      margin-bottom: 20px;
    }
    .valid { background: #d4f8d4; color: #0a7a0a; }
    .expired { background: #ffe0e0; color: #a30000; }
    .grace { background: #fff4cc; color: #8a6d00; }
    .invalid { background: #f2f2f2; color: #555; }
    code {
      background: #f4f4f4;
      padding: 3px 6px;
      border-radius: 4px;
    }
  </style>
</head>
<body>

  <h1>License Verification</h1>
  <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAoCAIAAACHGsgUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAFTGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4KPHg6eG1wbWV0YSB4bWxuczp4PSdhZG9iZTpuczptZXRhLyc+CjxyZGY6UkRGIHhtbG5zOnJkZj0naHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyc+CgogPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9JycKICB4bWxuczpBdHRyaWI9J2h0dHA6Ly9ucy5hdHRyaWJ1dGlvbi5jb20vYWRzLzEuMC8nPgogIDxBdHRyaWI6QWRzPgogICA8cmRmOlNlcT4KICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0nUmVzb3VyY2UnPgogICAgIDxBdHRyaWI6Q3JlYXRlZD4yMDI2LTAyLTA1PC9BdHRyaWI6Q3JlYXRlZD4KICAgICA8QXR0cmliOkRhdGE+eyZxdW90O2RvYyZxdW90OzomcXVvdDtEQUhBYlNqd1FKOCZxdW90OywmcXVvdDt1c2VyJnF1b3Q7OiZxdW90O1VBQmwtVC1lUjNrJnF1b3Q7LCZxdW90O2JyYW5kJnF1b3Q7OiZxdW90O0JBQmwtWEQ5OTVFJnF1b3Q7fTwvQXR0cmliOkRhdGE+CiAgICAgPEF0dHJpYjpFeHRJZD5mZGRlZGUwMi1iMzE3LTQ4YTAtODdlMi03MzY3YjI5NjgwMjc8L0F0dHJpYjpFeHRJZD4KICAgICA8QXR0cmliOkZiSWQ+NTI1MjY1OTE0MTc5NTgwPC9BdHRyaWI6RmJJZD4KICAgICA8QXR0cmliOlRvdWNoVHlwZT4yPC9BdHRyaWI6VG91Y2hUeXBlPgogICAgPC9yZGY6bGk+CiAgIDwvcmRmOlNlcT4KICA8L0F0dHJpYjpBZHM+CiA8L3JkZjpEZXNjcmlwdGlvbj4KCiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0nJwogIHhtbG5zOmRjPSdodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4x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" alt="Verified logo" width="100" height="40">
  <p id="loading">Checking license…</p>
  <div id="result"></div>

  <script>
(async function () {

  /* ---------------------------------------------------------
     STEP 1 — Read key from URL or session
  --------------------------------------------------------- */

  const params = new URLSearchParams(window.location.search);
  const urlKey = params.get("licenseKey");

  // If key exists in URL, store it for this session only
  if (urlKey) {
    sessionStorage.setItem("licenseKey", urlKey);

    // Clean the URL (remove ?licenseKey=...)
    const cleanUrl = window.location.origin + "/ytubestats-verify/";
    history.replaceState({}, "", cleanUrl);
  }

  // Load key from sessionStorage (works on refresh)
  const licenseKey = sessionStorage.getItem("licenseKey");

  console.log("License key being used:", licenseKey);

  // If no key at all, block access
  const loadingEl = document.getElementById("loading");
  const resultEl = document.getElementById("result");

  if (!licenseKey) {
    loadingEl.textContent = "No license key provided.";
    return;
  }


  /* ---------------------------------------------------------
     STEP 2 — Fetch license database
  --------------------------------------------------------- */

  try {
    const response = await fetch(
      "https://gist.githubusercontent.com/erickouassi/e6bdb0c49657bd73659c46b602573331/raw/2cbb6504ba4206ccdda4612dfcf8f572699f5e18/ytubestats.data.json",
      { cache: "no-store" }
    );

    const data = await response.json();

    const license = data.licenses.find(item => item.key === licenseKey);


    /* ---------------------------------------------------------
       STEP 3 — Handle invalid license
    --------------------------------------------------------- */

    if (!license) {
      loadingEl.remove();
      resultEl.innerHTML = `
        <div class="status invalid">INVALID LICENSE KEY</div>
        <p>The key <code>${licenseKey}</code> does not exist in our system.</p>
      `;
      return;
    }


    /* ---------------------------------------------------------
       STEP 4 — Determine license status
    --------------------------------------------------------- */

    let statusHTML = "";
    const today = new Date();

    if (license.expires === "never") {
      statusHTML = `<div class="status valid">VALID — Lifetime License</div>`;
    } else {
      const expires = new Date(license.expires);

      if (today <= expires) {
        statusHTML = `<div class="status valid">VALID — Active License</div>`;
      } else {
        const graceEnd = new Date(expires);
        graceEnd.setDate(graceEnd.getDate() + license.graceDays);

        if (today <= graceEnd) {
          statusHTML = `<div class="status grace">EXPIRED — In Grace Period</div>`;
        } else {
          statusHTML = `<div class="status expired">EXPIRED — No Longer Valid</div>`;
        }
      }
    }


    /* ---------------------------------------------------------
       STEP 5 — Render results
    --------------------------------------------------------- */

    loadingEl.remove();

    resultEl.innerHTML = `
      ${statusHTML}

      <h2>License Details</h2>
      <p><strong>License Key:</strong> <code>${license.key}</code></p>
      <p><strong>Type:</strong> ${license.type}</p>
      <p><strong>Activated:</strong> ${license.activated}</p>
      <p><strong>Expires:</strong> ${license.expires}</p>
      <p><strong>Grace Period:</strong> ${license.graceDays} days</p>
      <p><strong>Max Domains:</strong> ${license.maxDomains}</p>

      <h3>Approved Domains</h3>
      <ul>
        ${license.domains.map(d => `<li>${d}</li>`).join("")}
      </ul>
    `;

  } catch (err) {
    loadingEl.textContent = "Error loading license data.";
    console.error(err);
  }

})();
</script>


</body>
</html>
